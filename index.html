<!doctype html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <title>Menu</title>
  <link rel="icon" type="image/png" sizes="64x64" href="./favicon.png">

  <style>
    body {
      background: #333;
      color: white;
      font-family: Arial;
      text-align: center;
      overflow: hidden;
      margin: 0;
      padding: 0;
    }

    .titlemenu {
      font-size: 48px;
      margin-top: 80px;
      margin-bottom: 60px;
    }

    .buttonmenu img {
      cursor: pointer;
      margin: 8px;
      height: 100px;
    }

    .personnage-hobby img {
      width: 10%;
      min-width: 50px;
      max-width: 120px;
      position: fixed;
      user-select: none;
      pointer-events: none;
    }

    .platforme-hobby img {
      width: 20%;
      min-width: 100px;
      max-width: 250px;
      position: fixed;
      cursor: pointer;
    }
  </style>
</head>

<body>

  <img src="assets/logohome.png" style="width:105px; position:fixed; top:10px; left:10px;"
    onclick="window.location.href='./index.html'">
  <img src="assets/logoretour.png" style="width:105px; position:fixed; top:10px; left:125px;"
    onclick="window.location.href='./index.html'">
  <img src="assets/logorefresh.png" style="width:105px; position:fixed; top:10px; right:10px;"
    onclick="window.location.href='./index.html'">
  <img src="assets/logoparametre.png" style="width:105px; position:fixed; top:10px; right:125px;"
    onclick="window.location.href='./parametre.html'">

  <h1 class="titlemenu">MENU PRINCIPAL</h1>

  <div class="buttonmenu">
    <img src="assets/logoniveaux.png" onclick="window.location.href='./niv1a10.html'"><br>
    <img src="assets/logosolo.png" onclick="window.location.href='solo.html'"><br>
    <img src="assets/logoediteur.png" onclick="window.location.href='editeur.html'"><br>
    <img src="assets/logomesniveaux.png" onclick="window.location.href='mesniveaux.html'">
  </div>

  <div class="personnage-hobby">
    <img src="assets/personnagehobby.png" alt="Personnage">
  </div>

  <div class="platforme-hobby">
    <img src="assets/platformehobby.png" alt="Plateforme">
  </div>

  <script>
    const perso = document.querySelector(".personnage-hobby img");
    const plateforme = document.querySelector(".platforme-hobby img");

    let active = false;

    // Position relative en pourcentages pour le responsive
    let rightPercent = 8; // ~140px sur écran standard
    let bottomPercent = 40; // ~320px sur écran standard

    let velocityY = 0;
    let onPlatform = true;

    const gravity = 1.2;
    const jumpForce = 18;
    const speed = 6;

    const keys = {
      left: false,
      right: false
    };

    // Fonction pour positionner les éléments de manière responsive
    function updatePositions() {
      const screenWidth = window.innerWidth;
      const screenHeight = window.innerHeight;
      
      // Positionner la plateforme (coin bas-droit)
      const platformRightPercent = 5;
      const platformBottomPercent = 15;
      
      plateforme.style.right = platformRightPercent + '%';
      plateforme.style.bottom = platformBottomPercent + '%';
      
      // Position initiale du personnage (au-dessus de la plateforme)
      if (!active) {
        const platformRect = plateforme.getBoundingClientRect();
        const persoWidth = perso.offsetWidth;
        
        // Centrer le personnage sur la plateforme
        rightPercent = ((screenWidth - platformRect.right + platformRect.width / 2 - persoWidth / 2) / screenWidth) * 100;
        bottomPercent = ((platformRect.top - screenHeight + platformRect.height) / screenHeight) * 100 + 100;
        
        perso.style.right = rightPercent + '%';
        perso.style.bottom = bottomPercent + '%';
      }
    }

    // Position initiale
    updatePositions();

    // Repositionner lors du redimensionnement
    window.addEventListener('resize', () => {
      if (!active) {
        updatePositions();
      }
    });

    plateforme.addEventListener("click", () => {
      active = true;
      console.log("Easter egg activé");
    });

    document.addEventListener("keydown", (e) => {
      if (!active) return;

      if (e.key === "ArrowLeft") keys.left = true;
      if (e.key === "ArrowRight") keys.right = true;

      if (e.key === "ArrowUp" && onPlatform) {
        velocityY = jumpForce;
        onPlatform = false;
      }
    });

    document.addEventListener("keyup", (e) => {
      if (e.key === "ArrowLeft") keys.left = false;
      if (e.key === "ArrowRight") keys.right = false;
    });

    function loop() {
      if (active) {
        const screenWidth = window.innerWidth;
        const screenHeight = window.innerHeight;
        const persoWidth = perso.offsetWidth;
        const persoHeight = perso.offsetHeight;

        // Convertir le pourcentage en pixels pour les calculs
        let rightPx = (rightPercent / 100) * screenWidth;
        let bottomPx = (bottomPercent / 100) * screenHeight;

        // Déplacement horizontal fluide
        if (keys.left) rightPx += speed;
        if (keys.right) rightPx -= speed;

        // Gravité
        velocityY -= gravity;
        bottomPx += velocityY;

        // Limites écran
        if (rightPx < 0) rightPx = 0;
        if (rightPx > screenWidth - persoWidth) {
          rightPx = screenWidth - persoWidth;
        }

        // Collision avec la plateforme
        const platformRect = plateforme.getBoundingClientRect();
        const platformLeft = screenWidth - platformRect.right;
        const platformRight = screenWidth - platformRect.left;
        const platformTop = screenHeight - platformRect.bottom;

        const persoLeft = rightPx;
        const persoRight = rightPx + persoWidth;
        const persoBottom = bottomPx;

        // Vérifier si le personnage est au-dessus de la plateforme
        if (
          velocityY <= 0 &&
          bottomPx <= platformTop + platformRect.height + 10 &&
          bottomPx >= platformTop - 10 &&
          persoRight > platformLeft &&
          persoLeft < platformRight
        ) {
          bottomPx = platformTop + platformRect.height;
          velocityY = 0;
          onPlatform = true;
        } else if (bottomPx < platformTop + platformRect.height - 20) {
          onPlatform = false;
        }

        // Chute = level secret
        if (bottomPx < -200) {
          window.location.href = "level11.html";
        }

        // Reconvertir en pourcentages et appliquer
        rightPercent = (rightPx / screenWidth) * 100;
        bottomPercent = (bottomPx / screenHeight) * 100;

        perso.style.right = rightPercent + '%';
        perso.style.bottom = bottomPercent + '%';
      }

      requestAnimationFrame(loop);
    }

    loop();
  </script>

</body>

</html>
